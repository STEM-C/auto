let createAxiosInstance,getAppName,createApp,deleteApp;_254‍.x([["run",()=>run]]);_254‍.w("./util",[["createAxiosInstance",["createAxiosInstance"],function(v){createAxiosInstance=v}],["getAppName",["getAppName"],function(v){getAppName=v}]]);_254‍.w("./dataaccess",[["createApp",["createApp"],function(v){createApp=v}],["deleteApp",["deleteApp"],function(v){deleteApp=v}]]);


       const run = async ({ base, pipeline, stage, token, state, pr }) => {

	const axios = createAxiosInstance('https://api.heroku.com', token)
    const name = getAppName(base, pr)

    if (state == 'open') {

        return await createApp(axios, pipeline, stage, name)
    } else if (state == 'closed') {

        await deleteApp(axios, name)
    } else {
        
        throw Error(`Invalid pr state ${state}`)
    }
}